## 2025-05-15 - [XSS in Custom Markdown Renderer]
**Vulnerability:** The MarkdownPreview component was using `dangerouslySetInnerHTML` with raw user input processed through regexes, allowing for Cross-Site Scripting (XSS).
**Learning:** Custom markdown parsers that use string replacement to generate HTML must escape all HTML special characters in the input BEFORE applying any markdown rules. Additionally, links must be sanitized to prevent `javascript:` protocol exploits.
**Prevention:** Always escape user input when using `dangerouslySetInnerHTML`. For markdown-like features, implement a whitelist of allowed URL protocols and ensure all tags generated by the parser are controlled.

## 2025-05-22 - [Insecure Randomness in Utility Tools]
**Vulnerability:** Tools designed for generating random numbers, strings, or UUIDs were using `Math.random()`, which is not cryptographically secure and can lead to predictable outputs.
**Learning:** Even if a tool is not explicitly labeled as "secure," users often expect utility generators (especially for UUIDs) to have high entropy and unpredictability. Relying on `Math.random()` in a security-conscious application is a risk.
**Prevention:** Always use `window.crypto.getRandomValues()` or `crypto.randomUUID()` for any random generation. When using `getRandomValues` for numbers, implement rejection sampling to avoid modulo bias.

## 2025-06-01 - [XSS via Attribute Breakout in Markdown Parser]
**Vulnerability:** The linear regex-based markdown parser allowed for XSS by matching markdown symbols inside a URL and replacing them with HTML tags (like `<strong>`). These tags contained double quotes that broke out of the `href` attribute in the final `<a>` tag.
**Learning:** In multi-pass string replacement parsers, rules that add HTML attributes must be extremely restrictive about the characters they capture. Any rule that generates HTML tags can potentially "poison" the input for subsequent rules if they are not aware of existing tags.
**Prevention:** Ensure that rules capturing content for HTML attributes (like URLs) explicitly exclude tag-defining characters (`<` and `>`). Process such rules after any other rules that might inject tags into that context.
## 2025-05-28 - [Modulo Bias in Password Generation]
**Vulnerability:** The PasswordGenerator was using `array[i] % charset.length` to select characters, which introduced a slight bias towards certain characters when the random space (2^32) was not a multiple of the charset size.
**Learning:** Even when using cryptographically secure random values (CSPRNG), improper mathematical operations like modulo can degrade the entropy and introduce predictability.
**Prevention:** Always use rejection sampling when mapping a large random range to a smaller one that does not divide it evenly. This ensures a perfectly uniform distribution across all possible outputs.
## 2026-05-25 - [Prototype Pollution via Tool Map Lookups]
**Vulnerability:** The application was using a plain object for `toolsMap`, which is susceptible to prototype pollution if a user-controlled `toolId` (e.g., from a URL parameter) is used for direct property access.
**Learning:** Using `Object.create(null)` for maps that use external keys ensures that built-in object properties like `__proto__` or `toString` cannot be accessed or overridden.
**Prevention:** Always initialize lookup maps with a null prototype and use `Object.prototype.hasOwnProperty.call` to validate keys before access, especially when keys originate from URL parameters or user input.
