## 2025-05-15 - [XSS in Custom Markdown Renderer]
**Vulnerability:** The MarkdownPreview component was using `dangerouslySetInnerHTML` with raw user input processed through regexes, allowing for Cross-Site Scripting (XSS).
**Learning:** Custom markdown parsers that use string replacement to generate HTML must escape all HTML special characters in the input BEFORE applying any markdown rules. Additionally, links must be sanitized to prevent `javascript:` protocol exploits.
**Prevention:** Always escape user input when using `dangerouslySetInnerHTML`. For markdown-like features, implement a whitelist of allowed URL protocols and ensure all tags generated by the parser are controlled.

## 2025-05-22 - [Insecure Randomness in Utility Tools]
**Vulnerability:** Tools designed for generating random numbers, strings, or UUIDs were using `Math.random()`, which is not cryptographically secure and can lead to predictable outputs.
**Learning:** Even if a tool is not explicitly labeled as "secure," users often expect utility generators (especially for UUIDs) to have high entropy and unpredictability. Relying on `Math.random()` in a security-conscious application is a risk.
**Prevention:** Always use `window.crypto.getRandomValues()` or `crypto.randomUUID()` for any random generation. When using `getRandomValues` for numbers, implement rejection sampling to avoid modulo bias.

## 2025-06-01 - [XSS via Attribute Breakout in Markdown Parser]
**Vulnerability:** The linear regex-based markdown parser allowed for XSS by matching markdown symbols inside a URL and replacing them with HTML tags (like `<strong>`). These tags contained double quotes that broke out of the `href` attribute in the final `<a>` tag.
**Learning:** In multi-pass string replacement parsers, rules that add HTML attributes must be extremely restrictive about the characters they capture. Any rule that generates HTML tags can potentially "poison" the input for subsequent rules if they are not aware of existing tags.
**Prevention:** Ensure that rules capturing content for HTML attributes (like URLs) explicitly exclude tag-defining characters (`<` and `>`). Process such rules after any other rules that might inject tags into that context.
## 2025-05-28 - [Modulo Bias in Password Generation]
**Vulnerability:** The PasswordGenerator was using `array[i] % charset.length` to select characters, which introduced a slight bias towards certain characters when the random space (2^32) was not a multiple of the charset size.
**Learning:** Even when using cryptographically secure random values (CSPRNG), improper mathematical operations like modulo can degrade the entropy and introduce predictability.
**Prevention:** Always use rejection sampling when mapping a large random range to a smaller one that does not divide it evenly. This ensures a perfectly uniform distribution across all possible outputs.

## 2025-06-10 - [Prototype Pollution in Data Conversion and Registry Lookups]
**Vulnerability:** The JSON & CSV Converter and the main tool registry in `App.tsx` were susceptible to Prototype Pollution. In the converter, user-provided CSV headers were used as keys to build objects without sanitization. In the registry, tool ID lookups were performed on a standard object, allowing for potential property injection or accidental access to inherited methods like `toString`.
**Learning:** Any utility that converts user-provided keys into object properties must explicitly block special keys like `__proto__`, `constructor`, and `prototype`. Furthermore, using `Object.create(null)` for internal maps and data objects prevents inheritance-based pollution and makes lookups more predictable and secure.
**Prevention:** Always use null-prototype objects for data structures that map user-controlled keys. Implement explicit filtering for dangerous keys when processing structured data like CSV or JSON.
